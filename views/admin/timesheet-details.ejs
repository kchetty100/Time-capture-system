<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <h1>REVERSIDE <span class="logo-v">V</span> Time Tracker</h1>
            </div>
            <nav class="nav">
                <div class="nav-links">
                    <a href="/admin" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                    <a href="/admin/pending-timesheets" class="nav-link">
                        <i class="fas fa-clock"></i> Pending Timesheets
                    </a>
                    <a href="/admin/timesheets" class="nav-link">
                        <i class="fas fa-file-alt"></i> All Timesheets
                    </a>
                    <a href="/admin/employees" class="nav-link">
                        <i class="fas fa-users"></i> Employees
                    </a>
                    <a href="/admin/reports" class="nav-link">
                        <i class="fas fa-chart-bar"></i> Reports
                    </a>
                </div>
                <div class="user-info">
                    <span class="user-name"><%= user.name %></span>
                    <a href="/auth/logout" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                </div>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="page-header">
                <div class="page-title">
                    <h1>Timesheet Details</h1>
                    <p>View and manage timesheet information</p>
                </div>
                <div class="page-actions">
                    <a href="/admin/timesheets" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Timesheets
                    </a>
                </div>
            </div>

            <div class="timesheet-details">
                <!-- Timesheet Header -->
                <div class="timesheet-header-card">
                    <div class="timesheet-info">
                        <div class="info-section">
                            <h3>Timesheet Information</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="label">Employee:</span>
                                    <span class="value"><%= timesheet.user_name || 'Unknown' %></span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Week Ending:</span>
                                    <span class="value"><%= new Date(timesheet.week_ending).toLocaleDateString() %></span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Status:</span>
                                    <span class="status status-<%= timesheet.status %>">
                                        <%= timesheet.status.charAt(0).toUpperCase() + timesheet.status.slice(1) %>
                                    </span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Total Hours:</span>
                                    <span class="value"><%= timesheet.total_hours || '0.00' %></span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Submitted:</span>
                                    <span class="value"><%= new Date(timesheet.created_at).toLocaleDateString() %></span>
                                </div>
                                <% if (timesheet.notes) { %>
                                <div class="info-item full-width">
                                    <span class="label">Notes:</span>
                                    <span class="value"><%= timesheet.notes %></span>
                                </div>
                                <% } %>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Time Entries -->
                <div class="time-entries-section">
                    <div class="section-header">
                        <h3>Time Entries</h3>
                        <span class="entry-count"><%= timeEntries.length %> entries</span>
                    </div>

                    <% if (timeEntries.length > 0) { %>
                        <div class="time-entries-table">
                            <table class="entries-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Project</th>
                                        <th>Hours</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% timeEntries.forEach(entry => { %>
                                        <tr>
                                            <td class="date-cell">
                                                <%= new Date(entry.date).toLocaleDateString() %>
                                            </td>
                                            <td class="project-cell">
                                                <span class="project-name"><%= entry.project %></span>
                                            </td>
                                            <td class="hours-cell">
                                                <span class="hours-value"><%= entry.hours %></span>
                                            </td>
                                            <td class="description-cell">
                                                <%= entry.description || '-' %>
                                            </td>
                                        </tr>
                                    <% }); %>
                                </tbody>
                            </table>
                        </div>
                    <% } else { %>
                        <div class="empty-state">
                            <i class="fas fa-clock"></i>
                            <h4>No Time Entries</h4>
                            <p>This timesheet has no time entries recorded.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Actions -->
                <% if (timesheet.status === 'pending') { %>
                    <div class="timesheet-actions">
                        <div class="action-buttons">
                            <form method="POST" action="/admin/timesheets/<%= timesheet.id %>/approve" style="display: inline;">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-check"></i> Approve Timesheet
                                </button>
                            </form>
                            <form method="POST" action="/admin/timesheets/<%= timesheet.id %>/reject" style="display: inline;">
                                <button type="submit" class="btn btn-danger">
                                    <i class="fas fa-times"></i> Reject Timesheet
                                </button>
                            </form>
                        </div>
                    </div>
                <% } else { %>
                    <div class="timesheet-actions">
                        <div class="status-message">
                            <i class="fas fa-info-circle"></i>
                            This timesheet has been <%= timesheet.status %>.
                        </div>
                    </div>
                <% } %>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 REVERSIDE CONSULTING. All rights reserved.</p>
        </div>
    </footer>

    <style>
        .timesheet-details {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .timesheet-header-card {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
        }

        .timesheet-info h3 {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            font-size: 1.25rem;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-item.full-width {
            grid-column: 1 / -1;
        }

        .info-item .label {
            font-weight: 600;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        .info-item .value {
            color: var(--primary-blue);
            font-size: 1rem;
        }

        .status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .time-entries-section {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .section-header h3 {
            color: var(--primary-blue);
            margin: 0;
            font-size: 1.25rem;
        }

        .entry-count {
            background: var(--light-gray);
            color: var(--medium-gray);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .entries-table {
            width: 100%;
            border-collapse: collapse;
        }

        .entries-table th {
            background: var(--primary-blue);
            color: var(--white);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        .entries-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .entries-table tr:hover {
            background: #f8f9fa;
        }

        .date-cell {
            font-weight: 500;
            color: var(--primary-blue);
        }

        .project-cell .project-name {
            background: var(--light-gray);
            color: var(--dark-gray);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .hours-cell .hours-value {
            font-weight: 600;
            color: var(--primary-blue);
            font-size: 1.1rem;
        }

        .description-cell {
            color: var(--medium-gray);
        }

        .timesheet-actions {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .status-message {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--light-gray);
            border-radius: var(--border-radius);
            color: var(--medium-gray);
        }

        .status-message i {
            color: var(--primary-blue);
        }

        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--medium-gray);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--light-gray);
        }

        .empty-state h4 {
            margin: 0 0 0.5rem 0;
            color: var(--dark-gray);
        }

        .empty-state p {
            margin: 0;
        }

        @media (max-width: 768px) {
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .entries-table {
                font-size: 0.9rem;
            }
            
            .entries-table th,
            .entries-table td {
                padding: 0.75rem 0.5rem;
            }
        }
    </style>
</body>
</html>
